<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[(function() {
  /* Client-side script */
})();
]]></client_script>
        <controller_as>c</controller_as>
        <css>.item-card {
  border: 1px solid #ccc;
  padding: 10px;
  margin: 10px 0;
  border-radius: 5px;
}

.item-card h3 {
  margin: 0;
  color: #333;
}

.item-card p {
  margin: 5px 0;
  color: #666;
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>my_bid_history</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>My bid history</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  data.bids = [];
  var userSysId = gs.getUserID(); // Get the Sys ID of the logged-in user

  // Query the user_profile table to get the profile name
  var userProfileGR = new GlideRecord('x_1383184_charityb_user_profile');
  userProfileGR.addQuery('name', userSysId);
  userProfileGR.query();

  if (userProfileGR.next()) {
    var userProfileName = userProfileGR.getValue('name');

    // Query the Bid table for bids placed by the logged-in user (referenced through user profile name)
    var bidGR = new GlideRecord('x_1383184_charityb_bid');
    bidGR.addQuery('bidder', userProfileName);
    bidGR.query();

    while (bidGR.next()) {
      // Get the item details from the referenced Item table
      var itemGR = new GlideRecord('x_1383184_charityb_item');
      if (itemGR.get(bidGR.getValue('item_name'))) {
        // Add bid and item details to the data array
        data.bids.push({
          bid_amount: bidGR.getValue('bid_amount'),
          item_name: {
            display_value: itemGR.getDisplayValue('item_name')
          }
        });
      }
    }
  }
})();
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>lalitha</sys_created_by>
        <sys_created_on>2024-06-26 07:16:21</sys_created_on>
        <sys_id>6ed1609593c3021094e3f15a7bba10c8</sys_id>
        <sys_mod_count>22</sys_mod_count>
        <sys_name>My bid history</sys_name>
        <sys_package display_value="CharityBids" source="x_1383184_charityb">bcaeeadb9369421094e3f15a7bba1090</sys_package>
        <sys_policy/>
        <sys_scope display_value="CharityBids">bcaeeadb9369421094e3f15a7bba1090</sys_scope>
        <sys_update_name>sp_widget_6ed1609593c3021094e3f15a7bba10c8</sys_update_name>
        <sys_updated_by>lalitha</sys_updated_by>
        <sys_updated_on>2024-07-09 16:00:09</sys_updated_on>
        <template><![CDATA[<div>
  <h2>My Bid History</h2>
  <div ng-repeat="bid in c.data.bids">
    <div class="item-card">
      <h3>{{ bid.item_name.display_value }}</h3>
      <p>Bid Amount: {{ bid.bid_amount }}</p>
    </div>
  </div>
</div>
]]></template>
    </sp_widget>
</record_update>
