<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function() {
  /* widget controller */
  var c = this;
	
	 // Function to show item details
    c.showDetails = function(item) {
        c.selectedItem = item;
    };
};]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>item_details</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>item details</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
    // Initialize an array to hold the items
    data.items = [];

    // Define the table name
    var tableName = 'x_1383184_charityb_item';  // Replace with your actual table name

    // Create a new GlideRecord object
    var gr = new GlideRecord(tableName);
    if (gr.isValid()) {
        gr.query();

        // Status mapping
        var statusMapping = {
            'item_submitted': 'Item Submitted',
            'auction_scheduled': 'Auction Scheduled',
            'auction_in_progress': 'Auction In Progress',
            'auction_completed': 'Auction Completed'
        };

        // Loop through each record and add it to the items array
        while (gr.next()) {
            var donatorName = '';
            if (gr.donator) {
                var userGr = new GlideRecord('sys_user');
                if (userGr.get(gr.donator)) {
                    donatorName = userGr.getValue('name');
                }
            }

            var auctionStatus = gr.getValue('auction_status');
            var displayStatus = statusMapping[auctionStatus] || auctionStatus;

            data.items.push({
                item_name: gr.getValue('item_name'),
                donator: donatorName,
                start_date: gr.getValue('start_date'),
                end_date: gr.getValue('end_date'),
                value: gr.getValue('value'),
                start_bid_amount: gr.getValue('start_bid_amount'),
							  highest_bid_amount: gr.getValue('highest_bid_amount'),
                auction_status: displayStatus,
                image: gr.getDisplayValue('image'),
							description: gr.getValue('description')
            });
        }
    } else {
        gs.error('Invalid table name: ' + tableName);
    }
	
})();
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>christy</sys_created_by>
        <sys_created_on>2024-06-18 07:07:54</sys_created_on>
        <sys_id>343357ee93b2021094e3f15a7bba10e3</sys_id>
        <sys_mod_count>6</sys_mod_count>
        <sys_name>item details</sys_name>
        <sys_package display_value="CharityBids" source="x_1383184_charityb">bcaeeadb9369421094e3f15a7bba1090</sys_package>
        <sys_policy/>
        <sys_scope display_value="CharityBids">bcaeeadb9369421094e3f15a7bba1090</sys_scope>
        <sys_update_name>sp_widget_343357ee93b2021094e3f15a7bba10e3</sys_update_name>
        <sys_updated_by>christy</sys_updated_by>
        <sys_updated_on>2024-06-18 09:06:54</sys_updated_on>
        <template><![CDATA[<!--<div class="item-details">-->
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-name">{{c.selectedItem.item_name}}</h4>
    </div>
    <div class="imgC">
      <!--<img ng-src="{{c.selectedItem.image || 'https://dev203498.service-now.com/logo%20image.jpg'}}" alt="{{c.selectedItem.item_name}}" class="imgFix">-->
    </div>
    <div class="modal-body">
      <p><strong>Description:</strong> {{c.selectedItem.description}}</p>
      <p><strong>Start Date:</strong> {{c.selectedItem.start_date}}</p>
      <p><strong>End Date:</strong> {{c.selectedItem.end_date}}</p>
      <p><strong>Value:</strong> {{c.selectedItem.value}}</p>
      <p><strong>Start Bid:</strong> {{c.selectedItem.start_bid_amount}}</p>
      <p><strong>Highest Bid:</strong> {{c.selectedItem.highest_bid_amount}}</p>
      <p><strong>Status:</strong> {{c.selectedItem.auction_status}}</p>
      <div class="add-to-options">
        <button class="btn btn-secondary" ng-click="c.addTo('Bid For Item')">Bid</button>
      </div>
    </div>
  </div>
</div>
]]></template>
    </sp_widget>
</record_update>
