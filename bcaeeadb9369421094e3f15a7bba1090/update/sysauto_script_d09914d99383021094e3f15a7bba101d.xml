<?xml version="1.0" encoding="UTF-8"?><record_update table="sysauto_script">
    <sysauto_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <business_calendar/>
        <condition/>
        <conditional>false</conditional>
        <entered_time>1970-01-01 00:00:00</entered_time>
        <max_drift/>
        <name>Check the duration</name>
        <offset/>
        <offset_type>0</offset_type>
        <run_as display_value="Lalitha ">08a3aa4c93e9021094e3f15a7bba10e6</run_as>
        <run_as_tz/>
        <run_dayofmonth>1</run_dayofmonth>
        <run_dayofweek>1</run_dayofweek>
        <run_period>1970-01-01 00:00:10</run_period>
        <run_start>2024-06-26 06:40:09</run_start>
        <run_time>1970-01-01 00:00:00</run_time>
        <run_type>periodically</run_type>
        <script><![CDATA[var itemGR = new GlideRecord('x_1383184_charityb_item');

// Add query to fetch records where auction status is 'auction scheduled' or 'auction in progress'
itemGR.addQuery('auction_status', 'IN', 'auction scheduled,auction in progress');
itemGR.query();

while (itemGR.next()) {
    var startDate = new GlideDateTime(itemGR.getValue('start_date'));
    var endDate = new GlideDateTime(itemGR.getValue('end_date'));
    var currentDate = new GlideDateTime();
    var duration = '';

    // Case 1: Auction status is 'auction scheduled'
    if (itemGR.getValue('auction_status') === 'auction scheduled') {
        if (currentDate.compareTo(startDate) == 0) {
            // If start date is today
            duration = 'Today';
        } else if (currentDate.compareTo(startDate) < 0) {
            // If start date is in the future
            var daysToStart = GlideDateTime.subtract(startDate, currentDate);
            duration = daysToStart.getNumericValue() + ' days to start';
        }
    }

    // Case 2: Auction status is 'auction in progress'
    if (itemGR.getValue('auction_status') === 'auction in progress') {
        if (currentDate.compareTo(endDate) < 0) {
            // If end date is in the future
            var daysToEnd = GlideDateTime.subtract(endDate, currentDate);
            duration = daysToEnd.getNumericValue() + ' days to end';
        } else if (currentDate.compareTo(endDate) == 0) {
            // If end date is today
            duration = 'Ends today';
        } else {
            // If end date is in the past
            duration = 'Auction ended';
        }
    }

    // Update the duration field if it was set
    if (duration !== '') {
        itemGR.setValue('duration', duration);
        itemGR.update();
    }
}
]]></script>
        <sys_class_name>sysauto_script</sys_class_name>
        <sys_created_by>lalitha</sys_created_by>
        <sys_created_on>2024-06-26 06:47:51</sys_created_on>
        <sys_id>d09914d99383021094e3f15a7bba101d</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>Check the duration</sys_name>
        <sys_package display_value="CharityBids" source="x_1383184_charityb">bcaeeadb9369421094e3f15a7bba1090</sys_package>
        <sys_policy/>
        <sys_scope display_value="CharityBids">bcaeeadb9369421094e3f15a7bba1090</sys_scope>
        <sys_update_name>sysauto_script_d09914d99383021094e3f15a7bba101d</sys_update_name>
        <sys_updated_by>lalitha</sys_updated_by>
        <sys_updated_on>2024-06-26 06:51:04</sys_updated_on>
        <time_zone>GMT</time_zone>
        <upgrade_safe>false</upgrade_safe>
    </sysauto_script>
</record_update>
